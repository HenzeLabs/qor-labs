{%- comment -%}
  Product Spotlight Section
  Rapha-inspired split layout for featured product storytelling
  - Split layout: image left (60%), content right (40%)
  - Serif headline + body description + CTA button
  - Pulls from featured product or manual product picker
{%- endcomment -%}

{%- liquid
  assign product = section.settings.product
  assign custom_heading = section.settings.heading
  assign custom_description = section.settings.description
-%}

<section
  id="ProductSpotlight-{{ section.id }}"
  class="product-spotlight bg-{{ section.settings.background_color }} py-12 md:py-16 lg:py-24"
>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-[1400px]">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12 items-center {% if section.settings.image_position == 'right' %}lg:flex-row-reverse{% endif %}">

      {%- comment -%} Image Column (60%) {%- endcomment -%}
      <div class="lg:col-span-7 {% if section.settings.image_position == 'right' %}lg:order-2{% else %}lg:order-1{% endif %}">
        <div class="relative aspect-[4/5] md:aspect-[3/4] lg:aspect-[4/5] overflow-hidden bg-[#F7F7F5]">
          {%- if section.settings.custom_image != blank -%}
            {%- assign image = section.settings.custom_image -%}
          {%- elsif product != blank and product.featured_image -%}
            {%- assign image = product.featured_image -%}
          {%- else -%}
            {%- assign image = blank -%}
          {%- endif -%}

          {%- if image != blank -%}
            {%- assign image_height = image.width | divided_by: image.aspect_ratio -%}
            <img
              srcset="
                {%- if image.width >= 400 -%}{{ image | image_url: width: 400 }} 400w,{%- endif -%}
                {%- if image.width >= 600 -%}{{ image | image_url: width: 600 }} 600w,{%- endif -%}
                {%- if image.width >= 800 -%}{{ image | image_url: width: 800 }} 800w,{%- endif -%}
                {%- if image.width >= 1000 -%}{{ image | image_url: width: 1000 }} 1000w,{%- endif -%}
                {%- if image.width >= 1200 -%}{{ image | image_url: width: 1200 }} 1200w,{%- endif -%}
                {{ image | image_url }} {{ image.width }}w
              "
              src="{{ image | image_url: width: 1000 }}"
              sizes="(min-width: 1024px) 58vw, 100vw"
              alt="{{ image.alt | escape | default: product.title }}"
              width="{{ image.width }}"
              height="{{ image_height }}"
              loading="lazy"
              class="w-full h-full object-cover"
            >
          {%- else -%}
            <div class="w-full h-full flex items-center justify-center">
              {{ 'product-1' | placeholder_svg_tag: 'w-full h-full text-[#E0DED9]' }}
            </div>
          {%- endif -%}
        </div>
      </div>

      {%- comment -%} Content Column (40%) {%- endcomment -%}
      <div class="lg:col-span-5 {% if section.settings.image_position == 'right' %}lg:order-1{% else %}lg:order-2{% endif %}">
        <div class="max-w-lg {% if section.settings.image_position == 'right' %}lg:ml-auto{% endif %}">
          {%- comment -%} Overline {%- endcomment -%}
          {%- if section.settings.overline != blank -%}
            <p class="overline text-[11px] uppercase tracking-[0.15em] font-medium text-[#6B6B6B] mb-3 md:mb-4">
              {{ section.settings.overline }}
            </p>
          {%- endif -%}

          {%- comment -%} Heading {%- endcomment -%}
          {%- if custom_heading != blank -%}
            <h2 class="font-display text-[#1A1A1A] text-[28px] sm:text-[32px] md:text-[36px] lg:text-[42px] leading-[1.15] font-normal mb-4 md:mb-6">
              {{ custom_heading }}
            </h2>
          {%- elsif product != blank -%}
            <h2 class="font-display text-[#1A1A1A] text-[28px] sm:text-[32px] md:text-[36px] lg:text-[42px] leading-[1.15] font-normal mb-4 md:mb-6">
              {{ product.title }}
            </h2>
          {%- else -%}
            <h2 class="font-display text-[#1A1A1A] text-[28px] sm:text-[32px] md:text-[36px] lg:text-[42px] leading-[1.15] font-normal mb-4 md:mb-6">
              Featured Product
            </h2>
          {%- endif -%}

          {%- comment -%} Price {%- endcomment -%}
          {%- if section.settings.show_price and product != blank -%}
            <p class="text-[16px] md:text-[18px] text-[#1A1A1A] font-medium mb-4 md:mb-6">
              {%- if product.compare_at_price > product.price -%}
                <span class="line-through text-[#6B6B6B] mr-2">{{ product.compare_at_price | money }}</span>
              {%- endif -%}
              {{ product.price | money }}
            </p>
          {%- endif -%}

          {%- comment -%} Description {%- endcomment -%}
          {%- if custom_description != blank -%}
            <div class="font-body text-[#6B6B6B] text-[15px] md:text-[16px] leading-[1.7] mb-6 md:mb-8">
              {{ custom_description }}
            </div>
          {%- elsif product != blank and product.description != blank -%}
            <div class="font-body text-[#6B6B6B] text-[15px] md:text-[16px] leading-[1.7] mb-6 md:mb-8">
              {{ product.description | strip_html | truncatewords: 40 }}
            </div>
          {%- endif -%}

          {%- comment -%} Features List {%- endcomment -%}
          {%- if section.settings.feature_1 != blank or section.settings.feature_2 != blank or section.settings.feature_3 != blank -%}
            <ul class="mb-6 md:mb-8 space-y-2">
              {%- if section.settings.feature_1 != blank -%}
                <li class="flex items-center text-[14px] text-[#1A1A1A]">
                  <svg class="w-4 h-4 mr-3 text-[#2D5A3D] flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  {{ section.settings.feature_1 }}
                </li>
              {%- endif -%}
              {%- if section.settings.feature_2 != blank -%}
                <li class="flex items-center text-[14px] text-[#1A1A1A]">
                  <svg class="w-4 h-4 mr-3 text-[#2D5A3D] flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  {{ section.settings.feature_2 }}
                </li>
              {%- endif -%}
              {%- if section.settings.feature_3 != blank -%}
                <li class="flex items-center text-[14px] text-[#1A1A1A]">
                  <svg class="w-4 h-4 mr-3 text-[#2D5A3D] flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  {{ section.settings.feature_3 }}
                </li>
              {%- endif -%}
            </ul>
          {%- endif -%}

          {%- comment -%} CTA Button {%- endcomment -%}
          {%- if section.settings.button_label != blank -%}
            <a
              href="{% if section.settings.button_link != blank %}{{ section.settings.button_link }}{% elsif product != blank %}{{ product.url }}{% else %}#{% endif %}"
              class="btn btn-primary inline-flex items-center justify-center bg-[#0A0A0A] text-white uppercase tracking-[0.15em] text-[13px] font-medium px-8 py-4 hover:bg-[#333] transition-colors duration-300"
            >
              {{ section.settings.button_label }}
            </a>
          {%- endif -%}

          {%- comment -%} Secondary Link {%- endcomment -%}
          {%- if section.settings.secondary_link_label != blank -%}
            <a
              href="{% if section.settings.secondary_link_url != blank %}{{ section.settings.secondary_link_url }}{% elsif product != blank %}{{ product.url }}{% else %}#{% endif %}"
              class="ml-6 inline-flex items-center text-[13px] uppercase tracking-[0.1em] text-[#1A1A1A] underline underline-offset-4 hover:opacity-70 transition-opacity duration-300"
            >
              {{ section.settings.secondary_link_label }}
            </a>
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product Spotlight",
  "tag": "section",
  "class": "product-spotlight-section",
  "settings": [
    {
      "type": "header",
      "content": "Product"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product",
      "info": "Select a product to feature. Title, price, and description will be pulled automatically unless overridden."
    },
    {
      "type": "image_picker",
      "id": "custom_image",
      "label": "Custom Image",
      "info": "Optional. Overrides the product's featured image."
    },
    {
      "type": "header",
      "content": "Content Overrides"
    },
    {
      "type": "text",
      "id": "overline",
      "label": "Overline Text",
      "default": "Featured",
      "info": "Small uppercase text above the headline"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Custom Heading",
      "info": "Leave blank to use product title"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Custom Description",
      "info": "Leave blank to use product description"
    },
    {
      "type": "checkbox",
      "id": "show_price",
      "label": "Show Price",
      "default": true
    },
    {
      "type": "header",
      "content": "Features"
    },
    {
      "type": "text",
      "id": "feature_1",
      "label": "Feature 1",
      "default": "Free shipping over $100"
    },
    {
      "type": "text",
      "id": "feature_2",
      "label": "Feature 2",
      "default": "2-year warranty included"
    },
    {
      "type": "text",
      "id": "feature_3",
      "label": "Feature 3",
      "default": "Expert support available"
    },
    {
      "type": "header",
      "content": "Buttons"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Primary Button Label",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Primary Button Link",
      "info": "Leave blank to link to the product page"
    },
    {
      "type": "text",
      "id": "secondary_link_label",
      "label": "Secondary Link Label",
      "info": "Optional text link next to the button"
    },
    {
      "type": "url",
      "id": "secondary_link_url",
      "label": "Secondary Link URL"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image Position",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "background_color",
      "label": "Background Color",
      "options": [
        { "value": "white", "label": "White" },
        { "value": "surface", "label": "Off-White" },
        { "value": "off-white", "label": "Warm Gray" }
      ],
      "default": "surface"
    }
  ],
  "presets": [
    {
      "name": "Product Spotlight"
    }
  ]
}
{% endschema %}

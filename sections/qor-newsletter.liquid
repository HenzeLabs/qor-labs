{% comment %}
  Newsletter Section â€” Rapha-inspired minimal design
  Clean email signup with configurable background
  Single row on desktop, stacked on mobile
{% endcomment %}

<section
  class="py-12 md:py-20 lg:py-24 {% if section.settings.background_style == 'dark' %}bg-[#0A0A0A]{% elsif section.settings.background_style == 'surface' %}bg-surface{% else %}bg-white border-t border-[#E0DED9]{% endif %}"
  aria-labelledby="Newsletter-{{ section.id }}"
>
  <div class="max-w-7xl mx-auto px-4 md:px-8">
    <div class="max-w-2xl mx-auto text-center lg:max-w-none lg:flex lg:items-center lg:justify-between lg:text-left lg:gap-12">

      {%- comment -%} Text Content {%- endcomment -%}
      <div class="mb-8 lg:mb-0 lg:flex-1">
        {%- comment -%} Overline {%- endcomment -%}
        {%- if section.settings.overline != blank -%}
          <p class="text-[11px] uppercase tracking-[0.15em] font-medium {% if section.settings.background_style == 'dark' %}text-white/60{% else %}text-[#6B6B6B]{% endif %} mb-3">
            {{ section.settings.overline }}
          </p>
        {%- endif -%}

        {%- comment -%} Heading {%- endcomment -%}
        {%- if section.settings.heading != blank -%}
          <h2
            id="Newsletter-{{ section.id }}"
            class="font-display text-2xl md:text-3xl lg:text-4xl {% if section.settings.background_style == 'dark' %}text-white{% else %}text-[#1A1A1A]{% endif %} mb-3"
          >
            {{ section.settings.heading }}
          </h2>
        {%- endif -%}

        {%- comment -%} Description {%- endcomment -%}
        {%- if section.settings.description != blank -%}
          <p class="text-base {% if section.settings.background_style == 'dark' %}text-white/70{% else %}text-[#6B6B6B]{% endif %} max-w-md mx-auto lg:mx-0">
            {{ section.settings.description }}
          </p>
        {%- endif -%}
      </div>

      {%- comment -%} Form {%- endcomment -%}
      <div class="lg:flex-1 lg:max-w-md">
        {% form 'customer', class: 'newsletter-form' %}
          <input type="hidden" name="contact[tags]" value="newsletter">

          {%- comment -%} Form Fields {%- endcomment -%}
          <div class="flex flex-col sm:flex-row gap-3">
            <div class="flex-1">
              <label for="NewsletterEmail-{{ section.id }}" class="sr-only">
                {{ 'newsletter.label' | t | default: 'Email address' }}
              </label>
              <input
                id="NewsletterEmail-{{ section.id }}"
                type="email"
                name="contact[email]"
                value="{{ form.email }}"
                aria-required="true"
                autocorrect="off"
                autocapitalize="off"
                autocomplete="email"
                placeholder="{{ section.settings.placeholder | default: 'Enter your email' }}"
                required
                class="w-full px-4 py-4 text-base {% if section.settings.background_style == 'dark' %}bg-white/10 border-white/20 text-white placeholder-white/50 focus:border-white/50{% else %}bg-white border-[#E0DED9] text-[#1A1A1A] placeholder-[#9B9B9B] focus:border-[#0A0A0A]{% endif %} border outline-none transition-colors"
                {% if form.errors %}
                  autofocus
                  aria-invalid="true"
                  aria-describedby="Newsletter-error-{{ section.id }}"
                {% elsif form.posted_successfully? %}
                  aria-describedby="Newsletter-success-{{ section.id }}"
                {% endif %}
              >
            </div>
            <button
              type="submit"
              name="commit"
              class="{% if section.settings.background_style == 'dark' %}bg-white text-[#0A0A0A] hover:bg-white/90{% else %}bg-[#0A0A0A] text-white hover:bg-[#333]{% endif %} uppercase tracking-[0.15em] text-[13px] font-medium px-8 py-4 transition-colors"
            >
              {{ section.settings.button_text | default: 'Subscribe' }}
            </button>
          </div>

          {%- comment -%} Error State {%- endcomment -%}
          {%- if form.errors -%}
            <p
              id="Newsletter-error-{{ section.id }}"
              class="mt-3 text-sm text-[#C23B22] flex items-center justify-center lg:justify-start"
            >
              <svg class="w-4 h-4 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              {{ form.errors.translated_fields.email | capitalize }} {{ form.errors.messages.email }}
            </p>
          {%- endif -%}

          {%- comment -%} Success State {%- endcomment -%}
          {%- if form.posted_successfully? -%}
            <p
              id="Newsletter-success-{{ section.id }}"
              class="mt-3 text-sm {% if section.settings.background_style == 'dark' %}text-white{% else %}text-[#2D5A3D]{% endif %} flex items-center justify-center lg:justify-start"
              tabindex="-1"
              autofocus
            >
              <svg class="w-4 h-4 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              {{ section.settings.success_message | default: 'Thank you for subscribing!' }}
            </p>
          {%- endif -%}
        {% endform %}

        {%- comment -%} Privacy Note {%- endcomment -%}
        {%- if section.settings.privacy_text != blank -%}
          <p class="mt-4 text-[12px] {% if section.settings.background_style == 'dark' %}text-white/50{% else %}text-[#9B9B9B]{% endif %}">
            {{ section.settings.privacy_text }}
          </p>
        {%- endif -%}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Newsletter (Qor)",
  "tag": "section",
  "class": "qor-newsletter-section",
  "settings": [
    {
      "type": "header",
      "content": "Appearance"
    },
    {
      "type": "select",
      "id": "background_style",
      "label": "Background Style",
      "default": "surface",
      "options": [
        { "value": "white", "label": "White" },
        { "value": "surface", "label": "Off-White" },
        { "value": "dark", "label": "Dark" }
      ]
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "overline",
      "label": "Overline",
      "default": "Stay Updated"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Join Our Newsletter"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Get the latest on new products, lab insights, and exclusive offers delivered to your inbox."
    },
    {
      "type": "header",
      "content": "Form"
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Email Placeholder",
      "default": "Enter your email"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Subscribe"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success Message",
      "default": "Thank you for subscribing!"
    },
    {
      "type": "text",
      "id": "privacy_text",
      "label": "Privacy Note",
      "default": "We respect your privacy. Unsubscribe anytime."
    }
  ],
  "presets": [
    {
      "name": "Newsletter (Qor)"
    }
  ],
  "disabled_on": {
    "groups": ["header"]
  }
}
{% endschema %}

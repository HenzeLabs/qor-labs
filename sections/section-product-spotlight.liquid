{%- comment -%}
  SECTION: Product Spotlight
  RAPHA-EXACT values from RAPHA-SOURCE-ANALYSIS.md
  Split layout: 55% image / 45% content. Mobile: stacked.
{%- endcomment -%}

{%- liquid
  assign product = section.settings.product
  assign layout = section.settings.layout
  assign bg_color = section.settings.background_color

  if section.settings.image != blank
    assign image = section.settings.image
  elsif product != blank and product.featured_image != blank
    assign image = product.featured_image
  endif

  if section.settings.heading != blank
    assign heading = section.settings.heading
  elsif product != blank
    assign heading = product.title
  else
    assign heading = 'Featured Product'
  endif

  if section.settings.description != blank
    assign description = section.settings.description
  elsif product != blank and product.description != blank
    assign description = product.description | strip_html | truncatewords: 40
  endif

  if section.settings.button_link != blank
    assign btn_url = section.settings.button_link
  elsif product != blank
    assign btn_url = product.url
  else
    assign btn_url = '#'
  endif
-%}

<section
  id="ProductSpotlight-{{ section.id }}"
  class="product-spotlight product-spotlight--{{ layout }} product-spotlight--bg-{{ bg_color }}"
>
  <div class="product-spotlight__wrapper">
    {%- comment -%} Image Side {%- endcomment -%}
    <div class="product-spotlight__media">
      {%- if image != blank -%}
        <img
          src="{{ image | image_url: width: 1200 }}"
          srcset="
            {{ image | image_url: width: 600 }} 600w,
            {{ image | image_url: width: 900 }} 900w,
            {{ image | image_url: width: 1200 }} 1200w,
            {{ image | image_url: width: 1600 }} 1600w
          "
          sizes="(max-width: 1023px) 100vw, 55vw"
          alt="{{ image.alt | default: heading | escape }}"
          loading="lazy"
          width="{{ image.width }}"
          height="{{ image.height }}"
          class="product-spotlight__image"
        >
      {%- else -%}
        <div class="product-spotlight__placeholder">
          <span class="product-spotlight__placeholder-text">{{ heading }}</span>
        </div>
      {%- endif -%}
    </div>

    {%- comment -%} Content Side {%- endcomment -%}
    <div class="product-spotlight__content">
      <div class="product-spotlight__content-inner">
        {%- if section.settings.overline != blank -%}
          <span class="product-spotlight__overline">{{ section.settings.overline }}</span>
        {%- endif -%}

        <h2 class="product-spotlight__heading">{{ heading }}</h2>

        {%- if description != blank -%}
          <div class="product-spotlight__description">
            {{ description }}
          </div>
        {%- endif -%}

        {%- if product != blank -%}
          <div class="product-spotlight__price">
            {%- if product.compare_at_price > product.price -%}
              <span class="product-spotlight__price-sale">{{ product.price | money }}</span>
              <span class="product-spotlight__price-compare">{{ product.compare_at_price | money }}</span>
            {%- else -%}
              <span class="product-spotlight__price-regular">{{ product.price | money }}</span>
            {%- endif -%}
          </div>
        {%- endif -%}

        {%- if section.settings.button_label != blank -%}
          <div class="product-spotlight__cta">
            <a href="{{ btn_url }}" class="product-spotlight__btn">
              {{ section.settings.button_label }}
            </a>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</section>

<style>
  /* =====================================
     PRODUCT SPOTLIGHT - RAPHA EXACT VALUES
     Source: RAPHA-SOURCE-ANALYSIS.md
     ===================================== */

  .product-spotlight {
    width: 100%;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);  /* RAPHA EXACT */
  }

  .product-spotlight--bg-white {
    background-color: #FFFFFF;
  }

  .product-spotlight--bg-off-white {
    background-color: #F5F5F5;               /* RAPHA EXACT */
  }

  .product-spotlight--bg-warm-gray {
    background-color: #E8E6E1;
  }

  .product-spotlight__wrapper {
    display: flex;
    flex-direction: column;
  }

  /* RAPHA: Image takes dominant space, 1:1 aspect ratio mobile */
  .product-spotlight__media {
    position: relative;
    aspect-ratio: 1 / 1;
    overflow: hidden;
    background-color: #F5F5F5;               /* RAPHA EXACT */
  }

  .product-spotlight__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
  }

  /* Clean placeholder */
  .product-spotlight__placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #F5F5F5;               /* RAPHA EXACT */
  }

  .product-spotlight__placeholder-text {
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 400;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    color: #949494;
    text-align: center;
    padding: 16px;
  }

  /* RAPHA: content padding 32px/16px mobile */
  .product-spotlight__content {
    padding: 32px 16px;                      /* RAPHA mobile */
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .product-spotlight__content-inner {
    max-width: 480px;
    text-align: center;
  }

  /* Overline - RAPHA: 14px/600/0.3px uppercase */
  .product-spotlight__overline {
    display: block;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;                         /* RAPHA EXACT */
    font-weight: 600;                        /* RAPHA EXACT */
    text-transform: uppercase;
    letter-spacing: 0.3px;                   /* RAPHA EXACT */
    color: #6B6B6B;
    margin-bottom: 16px;
  }

  /* RAPHA EXACT: Heading 24px/600/uppercase on mobile */
  .product-spotlight__heading {
    font-family: 'DM Sans', sans-serif;
    font-size: 24px;                         /* RAPHA mobile */
    font-weight: 600;                        /* RAPHA EXACT */
    line-height: 24px;
    letter-spacing: 0.3px;                   /* RAPHA EXACT */
    text-transform: uppercase;
    color: #000000;
    margin: 0 0 16px;
  }

  /* RAPHA EXACT: body 16px/400/28px line-height */
  .product-spotlight__description {
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;                         /* RAPHA EXACT */
    font-weight: 400;                        /* RAPHA EXACT */
    line-height: 28px;                       /* RAPHA EXACT */
    color: #6B6B6B;
    margin-bottom: 24px;
  }

  /* Price styling */
  .product-spotlight__price {
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    font-weight: 400;
    margin-bottom: 24px;
  }

  .product-spotlight__price-regular,
  .product-spotlight__price-sale {
    color: #000000;
    font-weight: 600;
  }

  .product-spotlight__price-sale {
    color: #C23B22;
  }

  .product-spotlight__price-compare {
    color: #949494;
    text-decoration: line-through;
    margin-left: 8px;
  }

  .product-spotlight__cta {
    margin-top: 24px;
  }

  /* RAPHA EXACT: button 14px/600, 12px padding, 40px min-height */
  .product-spotlight__btn {
    box-sizing: border-box;
    display: inline-flex;
    align-items: center;
    justify-content: center;

    /* RAPHA typography */
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;                         /* RAPHA EXACT */
    font-weight: 600;                        /* RAPHA EXACT */
    line-height: 14px;
    letter-spacing: normal;                  /* RAPHA EXACT */
    text-transform: uppercase;
    text-decoration: none;
    text-align: center;

    /* RAPHA sizing */
    padding: 12px;                           /* RAPHA EXACT */
    min-height: 40px;                        /* RAPHA EXACT */
    min-width: 0;

    /* Colors */
    background-color: #000000;
    color: #FFFFFF;
    border: none;                            /* RAPHA EXACT */
    border-radius: 0;                        /* RAPHA EXACT */
    cursor: pointer;

    /* RAPHA transition */
    transition: background-color 250ms ease-in-out;
  }

  .product-spotlight__btn:hover {
    background-color: #2D5A3D;               /* Qor green */
  }

  /* Tablet and up: side by side */
  @media (min-width: 768px) {
    .product-spotlight__content {
      padding: 40px 32px;                    /* RAPHA desktop */
    }
  }

  @media (min-width: 992px) {
    .product-spotlight__wrapper {
      flex-direction: row;
      min-height: 600px;
    }

    .product-spotlight--image-right .product-spotlight__wrapper {
      flex-direction: row-reverse;
    }

    .product-spotlight__media {
      flex: 0 0 55%;                         /* RAPHA EXACT: 55/45 split */
      aspect-ratio: auto;
    }

    .product-spotlight__content {
      flex: 0 0 45%;
      padding: 64px 48px;
    }

    .product-spotlight__content-inner {
      text-align: left;
    }

    .product-spotlight__heading {
      font-size: 32px;                       /* RAPHA desktop */
      line-height: 32px;
    }
  }

  /* Large desktop */
  @media (min-width: 1280px) {
    .product-spotlight__content {
      padding: 80px 64px;
    }
  }
</style>

{% schema %}
{
  "name": "Product Spotlight",
  "tag": "section",
  "class": "section-product-spotlight",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product",
      "info": "Select a product to feature. Content below will override product data."
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Image position",
      "options": [
        { "value": "image-left", "label": "Image left" },
        { "value": "image-right", "label": "Image right" }
      ],
      "default": "image-left"
    },
    {
      "type": "select",
      "id": "background_color",
      "label": "Background color",
      "options": [
        { "value": "white", "label": "White" },
        { "value": "off-white", "label": "Off-white" },
        { "value": "warm-gray", "label": "Warm gray" }
      ],
      "default": "off-white"
    },
    {
      "type": "header",
      "content": "Image"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Custom image",
      "info": "Overrides the product image. Recommended: 1200x900px or larger."
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "overline",
      "label": "Overline",
      "default": "Featured Product"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "info": "Overrides the product title"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "info": "Overrides the product description"
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link",
      "info": "Leave blank to link to the selected product"
    }
  ],
  "presets": [
    {
      "name": "Product Spotlight",
      "settings": {
        "overline": "Featured Product",
        "button_label": "Shop Now"
      }
    }
  ]
}
{% endschema %}
